# 페이퍼 마리오  

오늘은 페이퍼 마리오 게임을 하다가 퍼즐이 나왔는데 그 퍼즐을 푸는 알고리즘을 포스팅 해보려 합니다.

일단 제가 풀어야될 알고리즘은 다음과 같이 몇개의 행동을 할 수 있는데요.
![](/images/paper_mario/1.gif)
위에 행동을 저를 가로 이동이라고 부르겠습니다.
아래에 세로 이동을 보여드리겠습니다

세로 이동은 움직이는 행동입니다.

다음은 소스코드입니다.

```
@Slf4j
public class PaperMarioTest {
  int[][] board = {
      {1, 1, 0, 1},
      {0, 0, 0, 0},
      {0, 1, 1, 0},
      {1, 1, 0, 0},
      {0, 0, 1, 0},
      {0, 0, 0, 0},
      {0, 0, 0, 0},
      {0, 0, 0, 0},
      {0, 0, 0, 0},
      {0, 0, 0, 0},
      {0, 0, 0, 0},
      {0, 0, 0, 0}
  };


  int maxCount = 2;
  Stack<String> process = new Stack<>();

  @Test
  void test1() {
    recursive(maxCount, process);
  }

  private void recursive(int maxCount, Stack<String> process) {
    if (checkSuccess()) {
      log.info("SUCCESS: {} ", process);
      return;
    }
    if (maxCount == 0)
      return;
    transverse(maxCount, process);
    vertical(maxCount, process);
  }

  private void transverse(int maxCount, Stack<String> process) {
    maxCount--;
    for (int i = 0; i < 12; i++) {
      if(allEmptyRow(i))
        continue;
      for (int j = 0; j < 8; j++) {
        moveRight(i, j);
        process.add("오른쪽 로우 :" + i + ", 횟수 :" + (j+1) +"\n");
        recursive(maxCount, process);
        process.pop();
        moveLeft(i, j);
      }
    }
  }

  private void vertical(int maxCount, Stack<String> process) {
    maxCount--;
    for (int i = 0; i < 4; i++) {
      if(allEmptyColumn(i))
        continue;
      for (int j = 0; j < 12; j++) {
        moveUpward(i, j);
        process.add("위쪽 컬럼 : " + i + ", 횟수 : " + (j+1) +"\n");
        recursive(maxCount, process);
        process.pop();
        moveDownward(i, j);
      }
    }
  }

  private boolean checkSuccess() {
    boolean result = true;
    for (int i = 0; i < 12; i++) {
      if (board[i][2] == 1) {
        if (!(board[i][0] == 1 && board[i][1] == 1 && board[i][3] == 1)) {
          checkReset();
          return false;
        }
        board[i][0] = board[i][1] = board[i][2] = board[i][3] = 2;
      }
    }
    for (int i = 0; i < 11; i++) {
      if (board[i][1] == 1) {
        if (!(board[i][0] == 1 && board[i + 1][0] == 1 && board[i + 1][1] == 1)) {
          checkReset();
          return false;
        }
        board[i][0] = board[i][1] = board[i + 1][0] = board[i + 1][1] = 2;
      }
    }
    if (board[11][1] == 1) {
      if (!(board[11][0] == 1 && board[0][0] == 1 && board[0][1] == 1)) {
        checkReset();
        return false;
      }

      board[11][1] = board[11][0] = board[0][0] = board[0][1] = 2;
    }
    //남은 1짜리가 있는지
    for(int i =0; i < 4; i++)
      for(int j = 0; j < 12; j++)
        if(board[j][i] == 1){
          checkReset();
          return false;
        }

    checkReset();
    return result;
  }

  private void checkReset() {
    for (int i = 0; i < 4; i++) {
      for (int j = 0; j < 12; j++) {
        if (board[j][i] == 2)
          board[j][i] = 1;
      }
    }
  }

  private void moveRight(int row, int count) {
    //0 6, 6 12, 6 0, 7 1,
    for (int i = 0; i <= count; i++) {
      int counterPart = (row + 6) % 12;
      int[] temp = {board[row][0], board[row][1], board[row][2], board[row][3],
          board[counterPart][0], board[counterPart][1], board[counterPart][2], board[counterPart][3]};
      board[row][0] = temp[4];
      board[row][1] = temp[0];
      board[row][2] = temp[1];
      board[row][3] = temp[2];
      board[counterPart][0] = temp[5];
      board[counterPart][1] = temp[6];
      board[counterPart][2] = temp[7];
      board[counterPart][3] = temp[3];
    }
  }

  private void moveLeft(int row, int count) {
    int counterPart = (row + 6) % 12;
    for (int i = 0; i <= count; i++) {
      int[] temp = {board[row][0], board[row][1], board[row][2], board[row][3],
          board[counterPart][0], board[counterPart][1], board[counterPart][2], board[counterPart][3]};
      board[row][0] = temp[1];
      board[row][1] = temp[2];
      board[row][2] = temp[3];
      board[row][3] = temp[7];
      board[counterPart][0] = temp[0];
      board[counterPart][1] = temp[4];
      board[counterPart][2] = temp[5];
      board[counterPart][3] = temp[6];
    }
  }

  private void moveDownward(int column, int count) {
    for (int i = 0; i <= count; i++) {
      int[] temp = {board[0][column], board[1][column], board[2][column], board[3][column], board[4][column], board[5][column],
          board[6][column], board[7][column], board[8][column], board[9][column], board[10][column], board[11][column]};
      board[0][column] = temp[11];
      board[1][column] = temp[0];
      board[2][column] = temp[1];
      board[3][column] = temp[2];
      board[4][column] = temp[3];
      board[5][column] = temp[4];
      board[6][column] = temp[5];
      board[7][column] = temp[6];
      board[8][column] = temp[7];
      board[9][column] = temp[8];
      board[10][column] = temp[9];
      board[11][column] = temp[10];
    }

  }

  private void moveUpward(int column, int count) {
    for (int i = 0; i <= count; i++) {
      int[] temp = {board[0][column], board[1][column], board[2][column], board[3][column], board[4][column], board[5][column],
          board[6][column], board[7][column], board[8][column], board[9][column], board[10][column], board[11][column]};
      board[0][column] = temp[1];
      board[1][column] = temp[2];
      board[2][column] = temp[3];
      board[3][column] = temp[4];
      board[4][column] = temp[5];
      board[5][column] = temp[6];
      board[6][column] = temp[7];
      board[7][column] = temp[8];
      board[8][column] = temp[9];
      board[9][column] = temp[10];
      board[10][column] = temp[11];
      board[11][column] = temp[0];
    }

  }
  private boolean allEmptyRow(int row){
    for(int i =0; i < 4; i++){
      int counterPart = (row + 6) % 12;
      if(board[row][i] == 1)
        return false;
      if(board[counterPart][i] == 1)
        return false;
    }
    return true;
  }
  private boolean allEmptyColumn(int column){
    for(int i =0; i < 12; i++){
      if(board[i][column] == 1)
        return false;
    }
    return true;

  }
}

```

위 코드를 실행하면 다음과 같이 나옵니다.

```
15:38:39.460 [main] INFO  codingTest.algorithm.PaperMarioTest - SUCCESS: [오른쪽 로우 :2, 횟수 :7
, 위쪽 컬럼 : 2, 횟수 : 4
] 
15:38:39.473 [main] INFO  codingTest.algorithm.PaperMarioTest - SUCCESS: [오른쪽 로우 :8, 횟수 :1
, 위쪽 컬럼 : 2, 횟수 : 4
] 
15:38:39.483 [main] INFO  codingTest.algorithm.PaperMarioTest - SUCCESS: [위쪽 컬럼 : 2, 횟수 : 2
, 오른쪽 로우 :2, 횟수 :7
] 
15:38:39.483 [main] INFO  codingTest.algorithm.PaperMarioTest - SUCCESS: [위쪽 컬럼 : 2, 횟수 : 2
, 오른쪽 로우 :8, 횟수 :1
] 

Process finished with exit code 0

```

그럼 위 명령대로 입력하면 클리어!
